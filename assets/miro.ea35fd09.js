import"./style.a87c9e06.js";import{r as l,j as i,a as g,R,c as h,A as b}from"./app.224f6158.js";const v=({children:n})=>{const r=miro.board.storage.collection("rollHistory"),[m,a]=l.exports.useState([]),[c,f]=l.exports.useState(null);let[s,p]=l.exports.useState(null);const e=[...s!=null?s:[]];for(const o of m)e.find(t=>t.id===o.id)||e.push(o);e.sort((o,t)=>o.timestamp.localeCompare(t.timestamp));const u=o=>{o.type==="completed"&&miro.board.events.broadcast("roll-result",`${o.userName} rolls ${o.total}!`);const t=[...e.filter(x=>x.id!==o.id),o].slice(-100);a(t),r.set("rollHistory",JSON.stringify(t))};l.exports.useEffect(()=>{miro.board.getUserInfo().then(o=>{f(o)}),r.onValue("rollHistory",o=>{o===void 0?r.set("rollHistory","[]"):p(JSON.parse(o))})},[]);const y=()=>{r.set("rollHistory","[]"),a([])};if(c===null||s===null)return i("div",{children:"Loading..."});const H={rollHistory:e,userInfo:c,panelData:miro.board.ui.getPanelData(),storeRollResult:u};return g(R.Provider,{value:H,children:[i("button",{className:"fw",style:{margin:"5px 0"},onClick:()=>y(),children:"Clear history"}),n]})},d=document.getElementById("root");d&&h(d).render(i(v,{children:i(b,{})}));
