import"./style.a87c9e06.js";import{r as l,j as i,R as x,c as g,A as v}from"./app.6cfb4deb.js";const b=({children:n})=>{const e=miro.board.storage.collection("rollHistory"),[m,a]=l.exports.useState([]),[c,f]=l.exports.useState(null),[s,p]=l.exports.useState(null),r=[...s!=null?s:[]];for(const o of m)r.find(t=>t.id===o.id)||r.push(o);r.sort((o,t)=>o.timestamp.localeCompare(t.timestamp));const u=o=>{o.type==="completed"&&miro.board.events.broadcast("roll-result",`${o.userName} rolls ${o.total}!`);const t=[...r.filter(R=>R.id!==o.id),o].slice(-100);a(t),e.set("rollHistory",JSON.stringify(t))};l.exports.useEffect(()=>{miro.board.getUserInfo().then(o=>{f(o)}),e.onValue("rollHistory",o=>{o===void 0?e.set("rollHistory","[]"):p(JSON.parse(o))})},[]);const y=()=>{e.set("rollHistory","[]"),a([])};if(c===null||s===null)return i("div",{children:"Loading..."});const H={rollHistory:r,userInfo:c,panelData:miro.board.ui.getPanelData(),storeRollResult:u,clearRollHistory:y};return i(x.Provider,{value:H,children:n})},d=document.getElementById("root");d&&g(d).render(i(b,{children:i(v,{})}));
