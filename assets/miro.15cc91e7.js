import"./style.a87c9e06.js";import{r as l,j as i,R as x,c as g,A as v}from"./app.e3336905.js";const b=({children:n})=>{const r=miro.board.storage.collection("rollHistory"),[m,a]=l.exports.useState([]),[c,f]=l.exports.useState(null);let[s,p]=l.exports.useState(null);const e=[...s!=null?s:[]];for(const o of m)e.find(t=>t.id===o.id)||e.push(o);e.sort((o,t)=>o.timestamp.localeCompare(t.timestamp));const u=o=>{o.type==="completed"&&miro.board.events.broadcast("roll-result",`${o.userName} rolls ${o.total}!`);const t=[...e.filter(R=>R.id!==o.id),o].slice(-100);a(t),r.set("rollHistory",JSON.stringify(t))};l.exports.useEffect(()=>{miro.board.getUserInfo().then(o=>{f(o)}),r.onValue("rollHistory",o=>{o===void 0?r.set("rollHistory","[]"):p(JSON.parse(o))})},[]);const y=()=>{r.set("rollHistory","[]"),a([])};if(c===null||s===null)return i("div",{children:"Loading..."});const H={rollHistory:e,userInfo:c,panelData:miro.board.ui.getPanelData(),storeRollResult:u,clearRollHistory:y};return i(x.Provider,{value:H,children:n})},d=document.getElementById("root");d&&g(d).render(i(b,{children:i(v,{})}));
